<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Perfil</title>
    <link rel="stylesheet" href="./css/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp"
      crossorigin="anonymous"
    />
    <script
      src="https://kit.fontawesome.com/533f790df8.js"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.2/awesomplete.min.css"
    />
  </head>
  <body>
    <profile-component></profile-component>
    <script src="profileComponent/profile.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.2/awesomplete.min.js"></script>
    <script>
      const API_TAGS =
        "https://stunning-capybara-1efe1a.netlify.app/.netlify/functions/api/tags";

      let hash = {};

      const getTags = async () => {
        const response = await fetch(API_TAGS);
        const data = await response.json();
        data.data.forEach((tag) => {
          hash[tag.note] = {
            name: tag.note,
            parent: tag.parent || null,
            children: tag.children || null,
          };
        });
        initializeAwesomplete();
      };

      let tags = getTags();

      var agregaHijos = function () {
        for (var key in hash) {
          var nodo = hash[key];
          if (nodo.parent !== null) {
            if (hash[nodo.parent].children === null)
              hash[nodo.parent].children = [];
            hash[nodo.parent].children.push(nodo.name);
          }
        }
      };

      const initializeAwesomplete = () => {
        new Awesomplete(document.getElementById("txtCajita"), {
          list: Object.keys(hash),
          filter: Awesomplete.FILTER_STARTSWITH,
        });
      };
    </script>
  </body>
</html>
